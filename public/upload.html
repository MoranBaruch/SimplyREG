<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Simplyâ€‘REG â€“ ×”×¢×œ××ª ××¡××š</title>
  <link href="https://fonts.googleapis.com/css?family=Assistant:wght@400;700&display=swap" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>
<body>
  <header>
    <span class="site-title">Simplyâ€‘REG</span>
    <span class="logo">
      <img src="logo.jpg" alt="Simplyâ€‘REG Logo" style="height:36px;width:36px;">
    </span>
  </header>
  <div class="upload-container">
    <form id="uploadForm">
      <label for="file">×‘×—×¨×™ ×§×•×‘×¥:</label>
      <input type="file" id="file" name="file" required accept=".pdf,.doc,.docx,.txt,.rtf">
      <label for="category">×§×˜×’×•×¨×™×”:</label>
      <select id="category" name="category" required>
        <option>×”×¤×™×§×•×— ×¢×œ ×”×‘× ×§×™×</option>
        <option>×¤×™×§×•×— ×¢×œ ××¢×¨×›×•×ª ×ª×©×œ×•××™×</option>
        <option>×××’×¨ × ×ª×•× ×™ ××©×¨××™</option>
      </select>
      <button class="upload-btn" type="submit">×”×¢×œ×” ××¡××š</button>
    </form>
    <div class="file-list" id="fileList"></div>
  </div>
  <script>
    document.getElementById('uploadForm').onsubmit = async function(e) {
      e.preventDefault();
      const form = document.getElementById('uploadForm');
      const formData = new FormData(form);
      const btn = form.querySelector("button");
      btn.textContent = "××¢×œ×”...";
      btn.disabled = true;
      try {
        const res = await fetch('/api/upload', { method: 'POST', body: formData });
        const data = await res.json();
        if (data.success) {
          alert("×”×§×•×‘×¥ ×”×•×¢×œ×” ×‘×”×¦×œ×—×”!");
          form.reset();
          loadFiles();
        } else {
          alert("×©×’×™××”: "+(data.error || "×‘×¢×™×” ×œ× ×™×“×•×¢×”"));
        }
      } catch (e) {
        alert("×©×’×™××” ×‘×—×™×‘×•×¨ ×œ×©×¨×ª");
      }
      btn.textContent = "×”×¢×œ×” ××¡××š";
      btn.disabled = false;
    };
    async function loadFiles() {
      const res = await fetch('/api/files');
      const files = await res.json();
      let html = "<b>×§×‘×¦×™× ×©×”×•×¢×œ×•:</b><br>";
      files.slice().reverse().forEach(f => {
        html += `<div class="file-item">ğŸ“„ <a href="/uploads/${encodeURIComponent(f.filename)}" target="_blank">${f.filename}</a> <span style="color:#0066cc;">[${f.category}]</span></div>`;
      });
      document.getElementById('fileList').innerHTML = html;
    }
    loadFiles();
  </script>
</body>
</html>